{"version":3,"file":"in-viewport.directive.js","sourceRoot":"","sources":["in-viewport.directive.ts"],"names":[],"mappings":"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","sourcesContent":["import {Directive, OnInit, OnDestroy, ElementRef, Output, EventEmitter} from '@angular/core';\nimport {Observable} from 'rxjs/Observable';\nimport 'rxjs/add/observable/fromEvent';\nimport 'rxjs/add/operator/debounceTime';\n\n@Directive({\n  selector: '[in-viewport]'\n})\n\nexport class InViewport implements OnInit, OnDestroy {\n  private scroll:any;\n  private resize:any;\n\n  @Output('inViewport') inViewport:EventEmitter<Object>;\n\n  constructor(private _el:ElementRef) {\n    this.inViewport = new EventEmitter();\n  }\n\n  ngOnInit() {\n    this.check();\n\n    this.scroll = Observable\n      .fromEvent(window, 'scroll').debounceTime(100).subscribe((event) => {\n        this.check();\n      });\n\n    this.resize = Observable\n      .fromEvent(window, 'resize').debounceTime(100).subscribe((event) => {\n        this.check();\n      });\n  }\n\n  ngOnDestroy() {\n    this.scroll.unsubscribe();\n    this.resize.unsubscribe();\n  }\n\n  check(partial:boolean = true, direction:string = 'both') {\n    const el = this._el.nativeElement;\n\n    const elSize = (el.offsetWidth * el.offsetHeight);\n\n    const rec = el.getBoundingClientRect();\n\n    const vp = {\n      width: window.innerWidth,\n      height: window.innerHeight\n    };\n\n    const tViz = rec.top >= 0 && rec.top < vp.height;\n    const bViz = rec.bottom > 0 && rec.bottom <= vp.height;\n\n    const lViz = rec.left >= 0 && rec.left < vp.width;\n    const rViz = rec.right > 0 && rec.right <= vp.width;\n\n    const vVisible = partial ? tViz || bViz : tViz && bViz;\n    const hVisible = partial ? lViz || rViz : lViz && rViz;\n\n    let event = {\n      target: el,\n      value: false\n    };\n\n    if (direction === 'both') {\n      event['value'] = (elSize && vVisible && hVisible) ? true : false;\n    }\n    else if (direction === 'vertical') {\n      event['value'] = (elSize && vVisible) ? true : false;\n    }\n    else if (direction === 'horizontal') {\n      event['value'] = (elSize && hVisible) ? true : false;\n    }\n\n    this.inViewport.emit(event);\n  }\n}\n"]}
